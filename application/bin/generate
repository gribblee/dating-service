#!/usr/bin/env php
<?php
// scripts/generate_handlers_autoload.php
$controllersDir = __DIR__ . "/../src/Controllers/";
$handlersDir = __DIR__ . '/../src/Handlers';
$autoloadFile = __DIR__ . '/../vendor/generate_autoload.php';

$requires = [];

$files = scandir($controllersDir);

foreach ($files as $file) {
    if (preg_match('/\.php$/', $file)) {
        $requires[] = "require_once __DIR__ . '/../src/Controllers/$file';";
    }
}

$files = scandir($handlersDir);
foreach ($files as $file) {
    if (preg_match('/\.php$/', $file)) {
        $requires[] = "require_once __DIR__ . '/../src/Handlers/$file';";
    }
}


$php = "<?php\n\n// Автогенерация: подключаем все handlers и controllers\n\n";
$php .= implode("\n", $requires) . "\n";

file_put_contents($autoloadFile, $php);

echo "Handlers and controllers autoload generated (" . count($requires) . " files).\n";
